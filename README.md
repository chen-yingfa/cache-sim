# 实验一：Cache Analysis

DDL：2021.4.3 00:00

清华大学，《计算机系统结构》（张广艳）的课程实验一。

计 82    陈英发    2018080073

## 编译方法

操作系统：Ubuntu 20.04

编程语言：C++11

实验平台：Lenovo y7000，WSL Ubuntu 20.04。

> 注：请使用 Linux 执行。

### 编译

在 lab1 目录下，执行：`make build`，结果程序是 `main`，位于 `lab1/src` 子目录下。

### 执行

> 注：程序的读入方法是固定的，不管怎样都会读入 `1.trace`、`2.trace`、`3.trace`、`4.trace`，并且不会读入任何其他文件。所以如果要改成其他输入文件，必须覆盖这四个文件。然后输出不管怎样都会是 `1.log`、`2.log`、`3.log`、`4.log`。
>
> 另外，以下执行任何 make 都会先编译一下（所以其实可以直接执行 `make all` 来检查）。

- 运行所有不同的 cache 组织和策略：`make all`

- 运行不同的 cache 组织：`make structure`

- 运行不同的替换策略：`make replace`

- 运行不同的写策略：`make write`

- 单独运行某一种参数：

  ```bash
  make build
  cd src && ./main <块大小> <组数> <替换策略> <写策略>
  ```

为了方便，代码中块大小（`block_size`）等于 0 代表全相连。

> 注：全相连非常慢，尤其是块大小比较小或者命中率比较低的时候，可能要一个小时以上。如果不想测试全相连，可以在测试文件（`run_structure.sh`）中注释掉。

**输出结果放到 `lab1/output` 子目录下**，实验中所要求的 log 文件就在此。另外在 `lab1/output/stats` 子目录下，有含有其他统计数据的文件，助教可以忽视。

### 文件结构

- **input**：存放 trace 文件
- **output**：存放模拟结果，包括每一个**重点 trace 的访问 Log**。
  - 另外每此用不同参数进行模拟，都会输出一个以参数命名的文件，其中含有一些统计数据。命名格式为：`stats_<块大小>_<块大小>_<块大小>_<块大小>_<块大小>.tsv` 。助教可以忽视。
- **report**：实验报告
- **src**：源代码
- **stats**：由 `stats.py` 生成，对 `output` 中的统计文件进行数据处理后的结果，助教可以忽视。
- `run_xxx.sh`：辅助执行文件，助教可以忽视。上述执行的 make 操作实际上就是运行这些文件。

